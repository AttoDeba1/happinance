CREATE  DATABASE happinance;

create table Temperature (
	id INT,
	ville VARCHAR(19),
	departement VARCHAR(2),
	temperature DECIMAL(3,1),
	jour DATE
);
insert into Temperature (id, ville, departement, temperature, jour) values (1, 'Villeneuve d Ascq', 59, 10.5, '9/4/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (2, 'Villeneuve d Ascq', 59, 18.5, '2/19/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (3, 'Lille', 59, 30.0, '12/8/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (4, 'Loos', 59, 36.5, '6/14/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (5, 'Villeneuve d Ascq', 59, 34.6, '10/27/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (6, 'Dunkerque', 59, 31.2, '5/14/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (7, 'Marcq-en-Barœul', 59, 13.7, '10/27/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (8, 'Marcq-en-Barœul', 59, 35.9, '9/24/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (9, 'Loos', 59, 39.4, '4/12/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (10, 'Armentières', 59, 10.3, '7/30/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (11, 'Lezennes', 59, 9.7, '3/21/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (12, 'Marcq-en-Barœul', 59, 21.2, '2/3/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (13, 'Loos', 59, 3.9, '10/28/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (14, 'Villeneuve d Ascq', 59, 5.6, '7/31/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (15, 'Loos', 59, 12.1, '4/24/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (16, 'Dunkerque', 59, 2.0, '7/2/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (17, 'Villeneuve d Ascq', 59, 5.7, '8/14/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (18, 'Armentières', 59, 2.1, '11/19/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (19, 'Villeneuve d Ascq', 59, 27.5, '3/1/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (20, 'Lezennes', 59, 37.4, '11/6/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (21, 'Dunkerque', 59, 32.3, '10/19/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (22, 'Noyelles-lès-Seclin', 59, 25.4, '2/24/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (23, 'Lille', 59, 3.7, '9/30/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (24, 'Armentières', 59, 31.5, '10/30/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (25, 'Armentières', 59, 38.1, '3/27/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (26, 'Armentières', 59, 26.2, '12/14/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (27, 'Noyelles-lès-Seclin', 59, 26.4, '7/3/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (28, 'Noyelles-lès-Seclin', 59, 14.5, '9/14/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (29, 'Noyelles-lès-Seclin', 59, 39.2, '5/19/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (30, 'Armentières', 59, 2.2, '4/30/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (31, 'Loos', 59, 30.2, '1/10/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (32, 'Loos', 59, 33.7, '5/30/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (33, 'Noyelles-lès-Seclin', 59, 31.3, '11/17/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (34, 'Armentières', 59, 23.2, '1/23/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (35, 'Lezennes', 59, 23.5, '4/22/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (36, 'Dunkerque', 59, 24.4, '8/20/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (37, 'Marcq-en-Barœul', 59, 13.7, '5/14/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (38, 'Lezennes', 59, 19.4, '5/22/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (39, 'Lezennes', 59, 22.9, '11/15/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (40, 'Lille', 59, 1.1, '2/23/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (41, 'Villeneuve d Ascq', 59, 35.0, '6/23/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (42, 'Noyelles-lès-Seclin', 59, 19.4, '4/16/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (43, 'Dunkerque', 59, 20.4, '10/23/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (44, 'Marcq-en-Barœul', 59, 6.4, '12/27/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (45, 'Villeneuve d Ascq', 59, 30.7, '5/23/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (46, 'Lezennes', 59, 36.0, '4/12/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (47, 'Dunkerque', 59, 9.4, '2/23/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (48, 'Marcq-en-Barœul', 59, 24.4, '2/7/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (49, 'Armentières', 59, 27.0, '1/19/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (50, 'Villeneuve d Ascq', 59, 3.1, '7/12/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (51, 'Loos', 59, 24.5, '6/7/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (52, 'Dunkerque', 59, 21.5, '10/8/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (53, 'Dunkerque', 59, 15.8, '10/31/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (54, 'Lezennes', 59, 5.2, '5/31/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (55, 'Loos', 59, 11.3, '12/2/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (56, 'Noyelles-lès-Seclin', 59, 15.8, '9/13/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (57, 'Marcq-en-Barœul', 59, 26.5, '5/8/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (58, 'Noyelles-lès-Seclin', 59, 36.4, '2/23/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (59, 'Marcq-en-Barœul', 59, 14.0, '7/10/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (60, 'Villeneuve d Ascq', 59, 31.5, '6/9/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (61, 'Loos', 59, 17.4, '11/25/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (62, 'Marcq-en-Barœul', 59, 2.8, '4/11/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (63, 'Lezennes', 59, 21.8, '5/12/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (64, 'Noyelles-lès-Seclin', 59, 33.1, '7/17/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (65, 'Armentières', 59, 7.8, '12/8/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (66, 'Lezennes', 59, 8.7, '2/14/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (67, 'Noyelles-lès-Seclin', 59, 18.0, '9/25/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (68, 'Lille', 59, 11.1, '9/17/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (69, 'Dunkerque', 59, 15.2, '11/2/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (70, 'Armentières', 59, 36.0, '5/6/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (71, 'Marcq-en-Barœul', 59, 39.8, '10/12/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (72, 'Lezennes', 59, 28.4, '10/12/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (73, 'Dunkerque', 59, 28.3, '7/26/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (74, 'Marcq-en-Barœul', 59, 10.5, '7/21/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (75, 'Marcq-en-Barœul', 59, 31.2, '3/19/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (76, 'Lezennes', 59, 24.0, '9/19/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (77, 'Lezennes', 59, 27.0, '1/27/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (78, 'Loos', 59, 8.7, '4/20/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (79, 'Noyelles-lès-Seclin', 59, 5.6, '10/1/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (80, 'Lille', 59, 4.5, '3/2/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (81, 'Armentières', 59, 30.4, '8/13/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (82, 'Noyelles-lès-Seclin', 59, 25.7, '6/2/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (83, 'Lezennes', 59, 2.0, '12/24/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (84, 'Dunkerque', 59, 22.1, '1/27/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (85, 'Lezennes', 59, 21.7, '10/8/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (86, 'Dunkerque', 59, 36.0, '3/2/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (87, 'Lezennes', 59, 11.3, '3/29/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (88, 'Armentières', 59, 33.8, '1/26/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (89, 'Noyelles-lès-Seclin', 59, 12.7, '12/29/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (90, 'Lille', 59, 37.5, '4/4/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (91, 'Dunkerque', 59, 14.9, '3/23/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (92, 'Loos', 59, 6.7, '11/20/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (93, 'Dunkerque', 59, 11.8, '12/6/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (94, 'Loos', 59, 19.0, '12/19/2021');
insert into Temperature (id, ville, departement, temperature, jour) values (95, 'Villeneuve d Ascq', 59, 15.6, '2/12/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (96, 'Villeneuve d Ascq', 59, 26.1, '2/28/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (97, 'Noyelles-lès-Seclin', 59, 18.2, '1/31/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (98, 'Marcq-en-Barœul', 59, 15.7, '6/27/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (99, 'Marcq-en-Barœul', 59, 31.5, '4/8/2022');
insert into Temperature (id, ville, departement, temperature, jour) values (100, 'Noyelles-lès-Seclin', 59, 9.4, '2/25/2022');



CREATE PROCEDURE getAverageTemperatureByCity @city nvarchar(50)
AS
SELECT AVG(temperature) as avg_temperature FROM Temperature WHERE ville = @city GROUP BY ville
GO


CREATE PROCEDURE getAllCitiesAverageTemperature
AS
SELECT ville, departement, AVG(temperature) as avg_temperature FROM Temperature GROUP BY ville
GO

